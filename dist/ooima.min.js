const DEBUG=!0,log=(...e)=>{console.log(...e)};class ooima{constructor(e,t){let s={ctrl:17};if(t=t||{hotkey:s.ctrl},this.ooima_options={listClassSelector:t.listClass||"ooima-list-item",hotkey:"string"==typeof t.hotkey?s[t.hotkey]:t.hotkey,selectedBG:"#00ff00"},!e)throw new Error("Missing target UL element");log("Inited ooima"),this.appid=this.uuid(),this.listParent=document.querySelectorAll(e),this.$listItems=[],this.classifyListItems(),this.events(),this.isHotkeyDown=!1,this.freshHotKeyUp=!1,this.mousePressedInterval,this.$selectedItems=[]}uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}classifyListItems(){log("Running classifier");let e=this;e.listParent.forEach(t=>{let s=document.createElement("div");s.innerHTML=`<button type="button" style="display:none" id="${e.appid}--done">Done</button>`,t.prepend(s),e.$listItems=t.querySelectorAll("li"),e.$listItems.forEach(t=>{t.className+=e.ooima_options.listClassSelector})})}events(){log("Initializing events");let e=this;e.$listItems.forEach(t=>{t.addEventListener("click",(function(){e.tapEvent(this)}))}),document.addEventListener("keydown",(function(t){17==t.keyCode&&(log("Multi on"),e.isHotkeyDown=!0,e.freshHotKeyUp=!1)})),document.addEventListener("keyup",(function(t){17==t.keyCode&&(log("Multi off"),e.isHotkeyDown=!1,e.freshHotKeyUp=!0)})),document.addEventListener("mousedown",(function(){e.pressedDown(e)})),document.addEventListener("mouseup",(function(){e.pressedUp(e)})),document.getElementById(`${e.appid}--done`).addEventListener("click",(function(){e.touchHighlight(!1)}))}pressedDown(e){e.mousePressedInterval=setTimeout((function(){e.touchHighlight(!0)}),1e3)}pressedUp(e){e.mousePressedInterval&&(clearTimeout(e.mousePressedInterval),e.mousePressedInterval=!1)}touchHighlight(e){log("touched ",e);let t=this,s=t.$listItems;if(log(t.$listItems),e){s.forEach(e=>{e.className+=" is--touched"}),document.getElementById(`${t.appid}--done`).style.display="block",t.isHotkeyDown=!0}else{s.forEach(e=>{e.className=e.className.split(" ").filter(e=>"is--touched"!=e).join(" ")}),document.getElementById(`${t.appid}--done`).style.display="none",t.isHotkeyDown=!1,t.freshHotKeyUp=!0}}tapEvent(e){let t=this;t.$selectedItems.indexOf(e)>-1?t.isHotkeyDown?t.unselectItem(e):(t.unselectAll(),t.freshHotKeyUp&&t.selectItem(e)):(t.isHotkeyDown||t.unselectAll(),t.selectItem(e))}selectItem(e){this.$selectedItems.push(e),e.style.background=this.ooima_options.selectedBG}unselectItem(e,t){let s=this;t||s.$selectedItems.splice(s.$selectedItems.indexOf(e),1),e.style.background=""}unselectAll(){let e=this;e.$selectedItems.forEach(t=>{e.unselectItem(t,!0)}),e.$selectedItems=[]}choosenItems(e){let t=this;return e?t.$selectedItems.map(e=>e.innerHTML):t.$selectedItems}}